#### 중요한 이유
- 이중데이터를 최소화하도록 도와줌
- 여러 테이블로부터 동시에 데이터를 추출할 수 있도록 함
- 관계수준의 무결성

## 관계의 종류
다이어그램은 최소 주키는 포함시켜서그려야함
약간 pk에관계된 행이몇개?의 관점에서보는게 좋은듯?
### 일대일
서로 하나의 레코드와만 연관될 때
부분 집합 테이블인 경우가 있음
![400](assets/DB2%20기말%20-%20관계-20240619021529744.png)
#### 연결 방법
주키와 외래키 이용
부분집합테이블의 경우 부모 테이블의 주키를 외래키로 가짐
![300](assets/DB2%20기말%20-%20관계-20240619031250428.png)
다이어그램의 연결점이 외래키로 가지는 부분이어야함
### 일대다
한레코드가 다른 테이블의 하나이상의 레코드와 연결 될 수있을때, 하지만 반대로는 오직하나의 레코드만 연관될 수 있을때
다중값필드를 해소하기위한 테이블은 1대다
![400](assets/DB2%20기말%20-%20관계-20240619021858740.png)
#### 연결 방법
주키와 외래키 이용
일반적으로 다이어그램에 표시할때 왼쪽이 1임

### 다대다
서로 하나의 레코드가 다른테이블의 여러 레코드와 연관될 수 있을 때
ex) 학생과 수업
![400](assets/DB2%20기말%20-%20관계-20240619022428660.png)
#### 문제와 해결
> 레코드끼리 어떻게 쉽게 연관시킬것인가

- 관계를 적절히 설정 시키지 않을경우 야기되는 문제
	- 정보추출 어려움
	- 중복데이터 다량포함
	- 삽입 갱신 삭제에 어려움
- 해결
	- 연결테이블로 다대다를 N:1 1:N형식으로 만들 수있음
	- 복합 주키를 구성!
	- 연결테이블은 관계의 성질을 나타내는 이름을 부여
	  ![400](assets/DB2%20기말%20-%20관계-20240619032718103.png)![400](assets/DB2%20기말%20-%20관계-20240619032318049.png)
	  
### 자기 참조 관계
한 테이블 내에서 레코드 사이에 존재하는것.
이것도 일대일, 일대다, 다대다가있음
![300](assets/DB2%20기말%20-%20관계-20240619023419298.png)

ex) 회원과 회원을소개해준사람을 같은테이블에 입력할때 발생할 수 있음
![200](assets/DB2%20기말%20-%20관계-20240619032845332.png)
구조를 주의 깊게 검사하고 추적할 필요가 있다면 새 테이블로 분리
자기참조관계가 정말 유용한지 확인
#### 자기참조관계 새테이블 만드는 경우
- 1대 다 : 유용한지 확인하고 만드샘![300](assets/DB2%20기말%20-%20관계-20240619033256291.png)
- 다대다 : 연결 테이블을 만드는데 이 필드들이 다 같은 부모에서 나옴
  ![400](assets/DB2%20기말%20-%20관계-20240619033413882.png)
## 관계 식별법
모든 테이블에 대해서 표를 만들어서 식별하면됨
아래 표에 몇대몇인지 적으면됨
구체적 연결이 있는 직접관계만 찾음
왼쪽이 주어(기준) 위쪽이 비교
![300](assets/DB2%20기말%20-%20관계-20240619023825463.png)
### 관계 식별을 위한 질문던지기
- 연결적
	- 걍 단순하고 직관적인 질문임
	- ex) A테이블의 레코드는 B테이블의 하나 이상의 레코드와 연관되는가
	- 이런식으로 관계에 관한질문을 직관적으로 물어보는 것
- 상황적
	- 소유지향 질문
		- 소유하다, 포함하다, 부분이다.와 같은 단어를 포함함
		- ex) 하나의 주문은 하나의 제품을 포함할 수 있는가
	- 행위 지향 질문
		- 만들다, 방문하다, 놓다, 가르치다, 등 동사를 수반함
		- ex) 한명의 직원이 한명이상의 다른 직원을 관리하는가?
### 관계 종류 판단 공식
- 1:1 + 1:1 = 1:1
- 1:1 + 1:N = 1:N
- 1:N + 1:N = N:M
![300](assets/DB2%20기말%20-%20관계-20240619025735390.png)


## 테이블 구조 검토
### 이상적인 테이블 요소
- 개체 또는 단일 주제를 나타냄
- 주 키를 가짐
- 다중 부분 , 다중값 필드를 포함하지 않음
- 계산된 필드들을 포함하지 않음
- 불필요한 이중 필드들을 포함하지 않음
- 최소한의 중복데이터만 포함함

### 키정제
- 외래키는 복사된 주키와 같은이름을 가져아함
	- 아니면 확인하기 힘듬
- 외래키는 주키를 위한 필드명세의 복제를 사용함
	- 명세종류 : replica
	- 부모테이블
	- 원본명세 : 부모 주키의 이름을 지정함
		- 필드이름은 어디테이블에서 ㅇ왔다
	- 설명: 테이블내 외래키의 목적을 설명함
- 외래키는 주키로부터 값을 도출한다

## 관계특성 설정
### 삭제 규칙 정의
고아 레코드를 방지하는데 도움이 됨
부모테이블 관점에서 삭제 규칙을 설정
- 거부(D) : 부모테이블 레코드를 삭제하지 않고 유지하고 비활성으로 지정
- 제약(R) : 자식테이블에 연관된 레코드가 있을 시, 부모 레코드를 삭제 하지 않음
- 연속(C) : 부모레코드를 삭제하고 자식테이블의 모든 연관된 레코드를 지움
- 널화(N)  :  부모레코드를 삭제하고 자식테이블의 연관된 레코드의 외래키 값을 널로 갱신함
- 기본값 설정(S) : 부모레코드를 삭제하고  자식테이블의 연관된 레코드의 외래키 값을 필드명세의 현재 기본값으로 갱신함
다이어그램에 그릴시 부모테이블쪽에 삭제규칙 종류를 적음
![](assets/DB2%20기말%20-%20관계-20240619074124440.png)


### 참여종류 식별(삽입할때)
연관된 테이블에 레코드를 입력하기전에 다른 테이블의 레코드가 반드시 있어야하는지 결정
- 강제적 : 연관된 테이블에 어떤 레코드를 입력하기전에 현재 테이블에 적어도 하나의 레코드가 반드시 있어야함 ( 수직)
- 선택적 : 연관된 테이블에 어떤 레코드를 입력하기전에 , 현재 테이블에 어떤 레코드가 있어야할 필요가 없음 (원)
![400](assets/DB2%20기말%20-%20관계-20240619074855103.png)
이거 보면 고객을 넣으면 직원이 반드시 할당되어야하지만
직원을 넣을때는 고객과 상관이없다